<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
    <meta name="description" content="网站描述">
    <meta name="keyword" content="">

    <title>oracle安装-centos7下安装oracle11gR2 | 九天博客</title>
    <link rel="shortcut icon" href="/images/logo.png">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    
<link rel="stylesheet" href="/css/style.css">

    
        
<link rel="stylesheet" href="/css/index.css">

    
<meta name="generator" content="Hexo 6.3.0"></head>
<body>
    <header>
    
    <div class="navbar-container">
    <nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="/">
                <img src="/images/logo.png" alt="" width="30" height="24" class="d-inline-block align-text-top">
                九天博客
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0 navbar-nav-scroll" style="--bs-scroll-height: 35vh;">
                    
                    <li class="nav-item">
                        <a class="nav-link" href="/">首页</a>
                    </li>
                    
                    <li class="nav-item">
                        <a class="nav-link" href="/projects">项目</a>
                    </li>
                    
                    <li class="nav-item">
                        <a class="nav-link" href="/essays">随笔</a>
                    </li>
                    
                    <li class="nav-item">
                        <a class="nav-link" href="/notes">笔记</a>
                    </li>
                    
                    <li class="nav-item">
                        <a class="nav-link" href="/about">关于</a>
                    </li>
                    
                </ul>

                <form class="d-flex" role="search">
                    <input class="form-control me-2" type="search" placeholder="" aria-label="Search">
                    <button class="btn btn-outline-success" type="submit">搜索</button>
                </form>
            </div>
        </div>
    </nav>
</div>

    
    
</header>

    <main><h1>oracle安装-centos7下安装oracle11gR2</h1>

<span>2022-10-11</span>
<div><span id="more"></span>

<h1 id="检查硬件要求"><a href="#检查硬件要求" class="headerlink" title="检查硬件要求"></a>检查硬件要求</h1><ul>
<li><p>检查处理器体系架构是否与Oracle安装包匹配</p>
<p><code>grep &quot;model name&quot; /proc/cpuinfo</code></p>
<p>这里显示8核AMD骁龙处理器，所以要求Oracle安装包也是AMD架构的。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@3 home]# grep &quot;model name&quot; /proc/cpuinfo</span><br><span class="line">model name	: AMD EPYC Processor</span><br><span class="line">model name	: AMD EPYC Processor</span><br><span class="line">model name	: AMD EPYC Processor</span><br><span class="line">model name	: AMD EPYC Processor</span><br><span class="line">model name	: AMD EPYC Processor</span><br><span class="line">model name	: AMD EPYC Processor</span><br><span class="line">model name	: AMD EPYC Processor</span><br><span class="line">model name	: AMD EPYC Processor</span><br></pre></td></tr></table></figure>
</li>
<li><p>检测系统架构是否与Oracle安装包匹配</p>
<p><code>uname -m</code></p>
<p>这里显示系统架构为X86_64，所以要求Oracle安装包也是基于X86_64位的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@3 home]# uname -m</span><br><span class="line">x86_64</span><br></pre></td></tr></table></figure>
</li>
<li><p>至少1GB RAM（这里为32GB!）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@3 home]# grep MemTotal /proc/meminfo</span><br><span class="line">MemTotal:       32779824 kB</span><br></pre></td></tr></table></figure>
</li>
<li><p><em>&#x2F;tmp</em> 目录至少有1GB硬盘空间</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@3 home]# df -h /tmp</span><br><span class="line">Filesystem      Size  Used Avail Use% Mounted on</span><br><span class="line">/dev/vda1        20G  3.9G   17G  20% /</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建swap交换空间</p>
<p>如果没有swap交换空间，静默安装的时候，会报错</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">检查交换空间: 可用的交换空间为 0 MB, 所需的交换空间为 150 MB。    未通过 &lt;&lt;&lt;&lt;</span><br></pre></td></tr></table></figure>

<p><code>dd if=/dev/zero of=/mnt/512MiB.swap bs=1024 count=524288</code></p>
<p><code>chmod 600 mnt/512MiB.swap</code></p>
<p><code>mkswap /mnt/512MiB.swap</code></p>
<p><code>swapon /mnt/512MiB.swap</code></p>
<p>查看是否创建成功</p>
<p><code>free -m</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@oracledb oraclesetup]# free -m</span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:          32011         323       27546         128        4141       31172</span><br><span class="line">Swap:           511           0         511</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="检测软件要求"><a href="#检测软件要求" class="headerlink" title="检测软件要求"></a>检测软件要求</h1><h2 id="安装依赖包"><a href="#安装依赖包" class="headerlink" title="安装依赖包"></a>安装依赖包</h2><p>查看哪些包还没有安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -q binutils compat-libstdc++-33 elfutils-libelf elfutils-libelf-devel gcc gcc-c++ glibc glibc-common glibc-devel glibc-headers ksh libaio libaio-devel libgcc libstdc++ libstdc++-devel make sysstat unixODBC unixODBC-devel | grep &quot;not installed&quot;</span><br></pre></td></tr></table></figure>

<p>输出示例</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">package compat-libstdc++-33 is not installed</span><br><span class="line">package elfutils-libelf-devel is not installed</span><br><span class="line">package gcc is not installed</span><br><span class="line">package gcc-c++ is not installed</span><br><span class="line">package glibc-devel is not installed</span><br><span class="line">package glibc-headers is not installed</span><br><span class="line">package ksh is not installed</span><br><span class="line">package libaio is not installed</span><br><span class="line">package libaio-devel is not installed</span><br><span class="line">package libstdc++-devel is not installed</span><br><span class="line">package sysstat is not installed</span><br><span class="line">package unixODBC is not installed</span><br><span class="line">package unixODBC-devel is not installed</span><br></pre></td></tr></table></figure>

<p>下载未安装的依赖包rpm文件，进行安装。</p>
<blockquote>
<p>阿里镜像站：<a target="_blank" rel="noopener" href="https://developer.aliyun.com/packageSearch">https://developer.aliyun.com/packageSearch</a></p>
</blockquote>
<p>由于内网无法连接访问外网，不能通过yum直接下载安装。</p>
<p><strong>一种方式是，在一台可访问外网的服务器上面启用yum缓存，下载rpm包，然后将缓存上传到内网服务中，进行离线安装。</strong></p>
<ul>
<li><p>设置外网服务器，开启yum缓存</p>
<p><code>vi/etc/yum.conf</code></p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keepcache=1</span><br></pre></td></tr></table></figure>
</li>
<li><p>外网服务器下载安装包</p>
<p><code>yum -y install --downloadonly xxx</code></p>
</li>
<li><p>将外网服务器缓存的rpm包上传到内网服务器</p>
<p>文件路径 &#x2F;var&#x2F;cache&#x2F;yum&#x2F;x86_64&#x2F;7&#x2F;base&#x2F;packages</p>
</li>
<li><p>内网服务从缓存中安装依赖包</p>
<p><code>yum -y -C install *.rpm</code></p>
</li>
<li><p>清除外网服务中的缓存</p>
<p>如果不需要外网服务器中缓存的安装文件了，可以将其清除。</p>
<p><code>yum clean headers</code></p>
<p><code>yum clean packages</code></p>
<p>关闭yum缓存</p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keepcache=0</span><br></pre></td></tr></table></figure></li>
</ul>
<p><strong>另一种方式是，下载全部的rpm离线包，rpm安装的时候不进行依赖关系检查</strong></p>
<p><code>rpm -Uvh --force --nodeps *.rpm</code></p>
<h1 id="安装前的配置工作"><a href="#安装前的配置工作" class="headerlink" title="安装前的配置工作"></a>安装前的配置工作</h1><p><strong>临时设置主机名</strong></p>
<p><code>hostname oracledb</code></p>
<p><strong>添加host记录</strong></p>
<p><code>vi /etc/hosts</code></p>
<p>添加记录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10.88.25.20     oracledb</span><br></pre></td></tr></table></figure>

<p><strong>关闭selinux</strong></p>
<p>selinux是一种增强型的安全系统，为了避免权限相关的问题，最好临时关闭它</p>
<p><code>setenforce 0</code></p>
<p><strong>关闭防火墙</strong></p>
<p><code>systemctl stop firewalld</code></p>
<p>禁止防火墙自启动</p>
<p><code>systemctl disable firewalld</code></p>
<p><strong>创建Oracle数据库要求的本地组和用户</strong></p>
<ul>
<li><p>创建 <em>oinstall</em> 和 <em>dba</em> 组</p>
<p><code>groupadd oinstall</code></p>
<p><code>groupadd dba</code></p>
<p>查看是否成功</p>
<p><code>grep oinstall /etc/group</code></p>
<p><code>grep dba /etc/group</code></p>
</li>
<li><p>创建 <em>oracle</em> 用户</p>
<p><code>useradd -g oinstall -G dba oracle</code></p>
<p>设置密码（SZsyy#8899）</p>
<p><code>passwd oracle</code></p>
<p>验证是否创成功</p>
<p><code>id oracle</code></p>
</li>
</ul>
<p><strong>配置内核参数</strong></p>
<p>内核参数如下</p>
<!-- ![](oracle内核参数.png) -->

<p>说明：</p>
<ul>
<li><p>要求各个参数不能小于给定的最小值</p>
</li>
<li><p><em>kernel.shmmax</em> 为物理内存RAM的一半（bytes）(32 x 1024 x 1024 x 1024 &#x2F; 2 &#x3D; 17179869184)</p>
</li>
<li><p><em>fs.file-max</em> 为系统级别的进程能够打开的文件句柄的最大数量，通过 <code>cat /proc/sys/fs/file-max</code> 查看当前值，这里设为为 6815744</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@3 home]# cat /proc/sys/fs/file-max</span><br><span class="line">3245380</span><br></pre></td></tr></table></figure>
</li>
<li><p>其它使用默认的最小值即可</p>
</li>
</ul>
<p><code>vi /etc/sysctl.conf</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">fs.aio-max-nr = 1048576</span><br><span class="line">fs.file-max = 6815744</span><br><span class="line">kernel.shmall = 2097152</span><br><span class="line">kernel.shmmax = 17179869184</span><br><span class="line">kernel.shmmni = 4096</span><br><span class="line">kernel.sem = 250 32000 100 128</span><br><span class="line">net.ipv4.ip_local_port_range = 9000 65500</span><br><span class="line">net.core.rmem_default = 262144</span><br><span class="line">net.core.rmem_max = 4194304</span><br><span class="line">net.core.wmem_default = 262144</span><br><span class="line">net.core.wmem_max = 1048586</span><br></pre></td></tr></table></figure>

<p>执行命令 <code>sysctl -p</code> ，使配置立即生效</p>
<p>执行命令 <code>sysctl -a</code>，查看配置是否成功。</p>
<p><strong>设置oracle用户的shell限制</strong></p>
<p>为了提高软件的性能，必须设置oracle用户的以下shell限制。</p>
<ul>
<li>打开文件描述符的最大数量</li>
<li>单个用户可用的最大进程数</li>
<li>进程堆栈段（segment）的最大size</li>
</ul>
<p><code>vi /etc/security/limits.conf</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">oracle           soft    nproc   2047</span><br><span class="line">oracle           hard    nproc   16384</span><br><span class="line">oracle           soft    nofile  1024</span><br><span class="line">oracle           hard    nofile  65536</span><br></pre></td></tr></table></figure>

<p><code>vi /etc/pam.d/login</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">session    required     /lib64/security/pam_limits.so</span><br><span class="line">session    required     pam_limits.so</span><br></pre></td></tr></table></figure>

<p><code>vi /etc/profile</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">if [ $USER = &quot;oracle&quot; ]; then</span><br><span class="line">        if [ $SHELL = &quot;/bin/ksh&quot; ]; then</span><br><span class="line">              ulimit -p 16384</span><br><span class="line">              ulimit -n 65536</span><br><span class="line">        else</span><br><span class="line">              ulimit -u 16384 -n 65536</span><br><span class="line">        fi</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<p><strong>创建Oracle要求的相关目录</strong></p>
<p>这里Oracle主目录在 <em>&#x2F;opt&#x2F;oracle&#x2F;</em> ，下面创建4个目录</p>
<p><code>mkdir -p /opt/oracle/product/11gR2</code></p>
<p><code>mkdir -p /opt/oracle/oradata</code></p>
<p><code>mkdir -p /opt/oracle/inventory</code></p>
<p><code>mkdir -p /opt/oracle/fast_recovery_area</code></p>
<p>修改属主及权限</p>
<p><code>chown -R oracle:oinstall /opt/oracle</code></p>
<p><code>chmod -R 775 /opt/oracle</code></p>
<p><strong>设置oracle用户环境变量</strong></p>
<p>切换到oracle用户</p>
<p><code>su - oracle</code></p>
<p>设置</p>
<p><code>vi ~/.bash_profile</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># oracle</span><br><span class="line">ORACLE_BASE=/opt/oracle</span><br><span class="line">ORACLE_HOME=$ORACLE_BASE/product/11gR2</span><br><span class="line">ORACLE_PID=orcl</span><br><span class="line">ORACLE_SID=orcl</span><br><span class="line">LANG=&quot;zh_CN.UTF-8&quot;</span><br><span class="line">NLS_LANG=&quot;SIMPLIFIED CHINESE_CHINA.AL32UTF8&quot;</span><br><span class="line">NLS_DATE_FORMAT=&quot;yyyy-mm-dd hh24:mi:ss&quot;</span><br><span class="line">export ORACLE_BASE ORACLE_HOME ORACLE_PID ORACLE_SID LANG NLS_LANG NLS_DATE_FORMAT </span><br><span class="line"></span><br><span class="line">PATH=$PATH:$ORACLE_HOME/bin</span><br><span class="line">export PATH</span><br></pre></td></tr></table></figure>

<p>使其立即生效</p>
<p><code>source ~/.bash_profile</code></p>
<h1 id="开始安装"><a href="#开始安装" class="headerlink" title="开始安装"></a>开始安装</h1><p>将oracle11gR2的2个安装包解压后，上传到内网服务中。这里上传到 <em>&#x2F;opt&#x2F;oraclesetup</em> 中。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[oracle@oracledb opt]$ ls oraclesetup/</span><br><span class="line">doc  install  response  rpm  runInstaller  sshsetup  stage  welcome.html</span><br></pre></td></tr></table></figure>

<p><strong>修改oracle静默安装文件</strong></p>
<p>切换到root用户 <code>su</code></p>
<p><code>vi oraclesetup/response/db_install.rsp</code></p>
<p>按照之前的配置进行修改</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">oracle.install.option=INSTALL_DB_SWONLY</span><br><span class="line">ORACLE_HOSTNAME=oracledb</span><br><span class="line">UNIX_GROUP_NAME=oinstall</span><br><span class="line">INVENTORY_LOCATION=/opt/oracle/inventory</span><br><span class="line">SELECTED_LANGUAGES=en,zh_CN</span><br><span class="line">ORACLE_HOME=/opt/oracle/product/11gR2</span><br><span class="line">ORACLE_BASE=/opt/oracle</span><br><span class="line">oracle.install.db.InstallEdition=EE</span><br><span class="line">oracle.install.db.DBA_GROUP=dba</span><br><span class="line">oracle.install.db.OPER_GROUP=dba</span><br><span class="line">DECLINE_SECURITY_UPDATES=true</span><br></pre></td></tr></table></figure>

<p><strong>静默执行安装脚本</strong></p>
<p>切换到root用户，修改oracle安装文件的属主与权限</p>
<p><code>su</code></p>
<p><code>chown -R oracle:oinstall /opt/oraclesetup</code></p>
<p><code>chmod -R 775 /opt/oraclesetup/</code></p>
<p>切换到oracle用户 <code>su - oracle</code></p>
<p><code>cd /opt/oraclesetup</code></p>
<p>执行静默安装脚本</p>
<blockquote>
<p>注意：db_install.rsp必须使用绝对路径</p>
</blockquote>
<p><code>./runInstaller -silent -ignorePrereq -ignoreSysPrereqs -responseFile /opt/oraclesetup/response/db_install.rsp</code></p>
<p>输出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[oracle@oracledb oraclesetup]$ ./runInstaller -silent -ignorePrereq -ignoreSysPrereqs -responseFile /opt/oraclesetup/response/db_install.rsp </span><br><span class="line">正在启动 Oracle Universal Installer...</span><br><span class="line"></span><br><span class="line">检查临时空间: 必须大于 120 MB。   实际为 16061 MB    通过</span><br><span class="line">检查交换空间: 必须大于 150 MB。   实际为 511 MB    通过</span><br><span class="line">准备从以下地址启动 Oracle Universal Installer /tmp/OraInstall2022-03-04_05-23-11AM. 请稍候...[oracle@oracledb oraclesetup]$ [WARNING] [INS-32055] 主产品清单位于 Oracle 基目录中。</span><br><span class="line">   原因: 主产品清单位于 Oracle 基目录中。</span><br><span class="line">   操作: Oracle 建议将此主产品清单放置在 Oracle 基目录之外的位置中。</span><br><span class="line">[WARNING] [INS-32055] 主产品清单位于 Oracle 基目录中。</span><br><span class="line">   原因: 主产品清单位于 Oracle 基目录中。</span><br><span class="line">   操作: Oracle 建议将此主产品清单放置在 Oracle 基目录之外的位置中。</span><br><span class="line">可以在以下位置找到本次安装会话的日志:</span><br><span class="line"> /opt/oracle/inventory/logs/installActions2022-03-04_05-23-11AM.log</span><br><span class="line"></span><br><span class="line">[oracle@oracledb oraclesetup]$ 以下配置脚本需要以 &quot;root&quot; 用户的身份执行。</span><br><span class="line"> #!/bin/sh </span><br><span class="line"> #要运行的 Root 脚本</span><br><span class="line"></span><br><span class="line">/opt/oracle/inventory/orainstRoot.sh</span><br><span class="line">/opt/oracle/product/11gR2/root.sh</span><br><span class="line">要执行配置脚本, 请执行以下操作:</span><br><span class="line">	 1. 打开一个终端窗口</span><br><span class="line">	 2. 以 &quot;root&quot; 身份登录</span><br><span class="line">	 3. 运行脚本</span><br><span class="line">	 4. 返回此窗口并按 &quot;Enter&quot; 键继续</span><br><span class="line"></span><br><span class="line">Successfully Setup Software.</span><br></pre></td></tr></table></figure>

<p>按照提示，切换到root用户，执行root.sh脚本</p>
<p><code>su</code></p>
<p><code>sh /opt/oracle/product/11gR2/root.sh</code></p>
<p><strong>静默配置数据库监听</strong></p>
<p>切换回oracle用户，配置监听</p>
<p><code>su - oracle</code></p>
<p><code>netca /silent /responseFile /opt/oraclesetup/response/netca.rsp</code></p>
<p>输出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[oracle@oracledb ~]$ netca /silent /responseFile /opt/oraclesetup/response/netca.rsp </span><br><span class="line"></span><br><span class="line">正在对命令行参数进行语法分析:</span><br><span class="line">参数&quot;silent&quot; = true</span><br><span class="line">参数&quot;responsefile&quot; = /opt/oraclesetup/response/netca.rsp</span><br><span class="line">完成对命令行参数进行语法分析。</span><br><span class="line">Oracle Net Services 配置:</span><br><span class="line">完成概要文件配置。</span><br><span class="line">Oracle Net 监听程序启动:</span><br><span class="line">    正在运行监听程序控制: </span><br><span class="line">      /opt/oracle/product/11gR2/bin/lsnrctl start LISTENER</span><br><span class="line">    监听程序控制完成。</span><br><span class="line">    监听程序已成功启动。</span><br><span class="line">监听程序配置完成。</span><br><span class="line">成功完成 Oracle Net Services 配置。退出代码是0</span><br></pre></td></tr></table></figure>

<p>会在 <em>&#x2F;opt&#x2F;oracle&#x2F;product&#x2F;11gR2&#x2F;network&#x2F;admin&#x2F;</em> 目录下生成 <em>listener.ora</em> 和 <em>sqlnet.org</em> 2个文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[oracle@oracledb ~]$ ls /opt/oracle/product/11gR2/network/admin/</span><br><span class="line">listener.ora  samples  shrept.lst  sqlnet.ora</span><br></pre></td></tr></table></figure>

<p>通过netstat命令可以看到1521端口正在被监听</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[oracle@oracledb ~]$ netstat -tnulp | grep 1521</span><br><span class="line">(Not all processes could be identified, non-owned process info</span><br><span class="line"> will not be shown, you would have to be root to see it all.)</span><br><span class="line">tcp6       0      0 :::1521                 :::*                    LISTEN      16855/tnslsnr</span><br></pre></td></tr></table></figure>

<p><strong>静默创建数据库实例</strong></p>
<p>修改 <em>dbca.rsp</em> 文件</p>
<p><code>cd /opt/</code></p>
<p><code>vi oraclesetup/response/dbca.rsp</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">GDBNAME= &quot;orcl&quot;</span><br><span class="line">SID =&quot;orcl&quot;</span><br><span class="line">SYSPASSWORD= &quot;SZsyy#8899&quot;</span><br><span class="line">SYSTEMPASSWORD= &quot;SZsyy#8899&quot;</span><br><span class="line">SYSMANPASSWORD= &quot;SZsyy#8899&quot;</span><br><span class="line">DBSNMPPASSWORD= &quot;SZsyy#8899&quot;</span><br><span class="line">DATAFILEDESTINATION=/opt/oracle/oradata</span><br><span class="line">RECOVERYAREADESTINATION=/opt/oracle/fast_recovery_area</span><br><span class="line">CHARACTERSET= &quot;AL32UTF8&quot;</span><br><span class="line">TOTALMEMORY= &quot;1024&quot; # 总内存,MB</span><br></pre></td></tr></table></figure>

<p>执行脚本创建数据库实例</p>
<p><code>dbca -silent -responseFile /opt/oraclesetup/response/dbca.rsp</code></p>
<p>输出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[oracle@oracledb opt]$ dbca -silent -responseFile /opt/oraclesetup/response/dbca.rsp </span><br><span class="line">复制数据库文件</span><br><span class="line">1% 已完成</span><br><span class="line">3% 已完成</span><br><span class="line">11% 已完成</span><br><span class="line">18% 已完成</span><br><span class="line">26% 已完成</span><br><span class="line">37% 已完成</span><br><span class="line">正在创建并启动 Oracle 实例</span><br><span class="line">40% 已完成</span><br><span class="line">45% 已完成</span><br><span class="line">50% 已完成</span><br><span class="line">55% 已完成</span><br><span class="line">56% 已完成</span><br><span class="line">60% 已完成</span><br><span class="line">62% 已完成</span><br><span class="line">正在进行数据库创建</span><br><span class="line">66% 已完成</span><br><span class="line">70% 已完成</span><br><span class="line">73% 已完成</span><br><span class="line">85% 已完成</span><br><span class="line">96% 已完成</span><br><span class="line">100% 已完成</span><br><span class="line">有关详细信息, 请参阅日志文件 &quot;/opt/oracle/cfgtoollogs/dbca/orcl/orcl.log&quot;。</span><br></pre></td></tr></table></figure>

<p>OK，大公告成！</p>
<p>查看进程信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[oracle@oracledb opt]$ ps -aux | grep &#x27;orcl&#x27;</span><br><span class="line">oracle   19169  0.0  0.0 2329240 16076 ?       Ss   06:17   0:00 ora_pmon_orcl</span><br><span class="line">oracle   19171  0.0  0.0 2326992 12640 ?       Ss   06:17   0:00 ora_vktm_orcl</span><br><span class="line">oracle   19175  0.0  0.0 2326992 12628 ?       Ss   06:17   0:00 ora_gen0_orcl</span><br><span class="line">oracle   19177  0.0  0.0 2326992 12660 ?       Ss   06:17   0:00 ora_diag_orcl</span><br><span class="line">oracle   19179  0.0  0.0 2327516 21640 ?       Ss   06:17   0:00 ora_dbrm_orcl</span><br><span class="line">oracle   19181  0.0  0.0 2326992 12864 ?       Ss   06:17   0:00 ora_psp0_orcl</span><br><span class="line">oracle   19183  0.0  0.0 2327504 15876 ?       Ss   06:17   0:00 ora_dia0_orcl</span><br><span class="line">oracle   19185  1.2  0.1 2326992 54848 ?       Ss   06:17   0:00 ora_mman_orcl</span><br><span class="line">oracle   19187  0.0  0.0 2332748 19324 ?       Ss   06:17   0:00 ora_dbw0_orcl</span><br><span class="line">oracle   19189  0.0  0.0 2342544 18996 ?       Ss   06:17   0:00 ora_lgwr_orcl</span><br><span class="line">oracle   19191  0.0  0.0 2327504 16008 ?       Ss   06:17   0:00 ora_ckpt_orcl</span><br><span class="line">oracle   19193  0.0  0.0 2327504 30648 ?       Ss   06:17   0:00 ora_smon_orcl</span><br><span class="line">oracle   19195  0.0  0.0 2327504 21776 ?       Ss   06:17   0:00 ora_reco_orcl</span><br><span class="line">oracle   19197  0.3  0.1 2330836 60592 ?       Ss   06:17   0:00 ora_mmon_orcl</span><br><span class="line">oracle   19199  0.0  0.0 2326992 17572 ?       Ss   06:17   0:00 ora_mmnl_orcl</span><br><span class="line">oracle   19201  0.0  0.0 2352488 13220 ?       Ss   06:17   0:00 ora_d000_orcl</span><br><span class="line">oracle   19203  0.0  0.0 2328056 11780 ?       Ss   06:17   0:00 ora_s000_orcl</span><br><span class="line">oracle   19253  0.0  0.0 2326992 14560 ?       Ss   06:17   0:00 ora_qmnc_orcl</span><br><span class="line">oracle   19269  0.1  0.1 2331600 43304 ?       Ss   06:17   0:00 ora_cjq0_orcl</span><br><span class="line">oracle   19279  0.0  0.0 2328536 29160 ?       Ss   06:17   0:00 ora_q000_orcl</span><br><span class="line">oracle   19281  0.0  0.0 2326988 15684 ?       Ss   06:17   0:00 ora_q001_orcl</span><br><span class="line">oracle   19330  0.0  0.0 112832   976 pts/0    S+   06:18   0:00 grep --color=auto orcl</span><br></pre></td></tr></table></figure>

<p>查看监听状态</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[oracle@oracledb opt]$ lsnrctl status</span><br><span class="line"></span><br><span class="line">LSNRCTL for Linux: Version 11.2.0.1.0 - Production on 04-3月 -2022 06:20:00</span><br><span class="line"></span><br><span class="line">Copyright (c) 1991, 2009, Oracle.  All rights reserved.</span><br><span class="line"></span><br><span class="line">正在连接到 (DESCRIPTION=(ADDRESS=(PROTOCOL=IPC)(KEY=EXTPROC1521)))</span><br><span class="line">LISTENER 的 STATUS</span><br><span class="line">------------------------</span><br><span class="line">别名                      LISTENER</span><br><span class="line">版本                      TNSLSNR for Linux: Version 11.2.0.1.0 - Production</span><br><span class="line">启动日期                  04-3月 -2022 05:40:45</span><br><span class="line">正常运行时间              0 天 0 小时 39 分 15 秒</span><br><span class="line">跟踪级别                  off</span><br><span class="line">安全性                    ON: Local OS Authentication</span><br><span class="line">SNMP                      OFF</span><br><span class="line">监听程序参数文件          /opt/oracle/product/11gR2/network/admin/listener.ora</span><br><span class="line">监听程序日志文件          /opt/oracle/diag/tnslsnr/oracledb/listener/alert/log.xml</span><br><span class="line">监听端点概要...</span><br><span class="line">  (DESCRIPTION=(ADDRESS=(PROTOCOL=ipc)(KEY=EXTPROC1521)))</span><br><span class="line">  (DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=oracledb)(PORT=1521)))</span><br><span class="line">服务摘要..</span><br><span class="line">服务 &quot;orcl&quot; 包含 1 个实例。</span><br><span class="line">  实例 &quot;orcl&quot;, 状态 READY, 包含此服务的 1 个处理程序...</span><br><span class="line">服务 &quot;orclXDB&quot; 包含 1 个实例。</span><br><span class="line">  实例 &quot;orcl&quot;, 状态 READY, 包含此服务的 1 个处理程序...</span><br><span class="line">命令执行成功</span><br></pre></td></tr></table></figure>

<p>使用sqlplus进入数据库</p>
<p><code>sqlplus / as sysdba</code></p>
<p>查看数据库实例</p>
<p><code>select host_name,status from v$instance;</code></p>
<p>可以使用上面的方法创建多个数据库实例。</p>
</div>
<div>END</div></main>

    <footer>
页底
</footer>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    
</body>
</html>