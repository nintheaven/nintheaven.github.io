<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
    <meta name="description" content="">
    <meta name="keyword" content="">

    <title>spring-ioc容器配置的3种方式 | Nintheaven</title>
    <link rel="shortcut icon" href="/images/favicon.ico">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    
    
<link rel="stylesheet" href="/css/style.css">

    
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css">
        
<link rel="stylesheet" href="/css/highlight/github.css">

        
<link rel="stylesheet" href="/css/post.css">

    
<meta name="generator" content="Hexo 6.3.0"></head>
<body>
    <header>
    
    <div class="navbar-container">
    <nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="/">
                <img src="/images/favicon.ico" alt="" width="30" height="24" class="d-inline-block align-text-top">
                Nintheaven
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0 navbar-nav-scroll" style="--bs-scroll-height: 35vh;">
                    
                    <li class="nav-item">
                        <a class="nav-link" href="/">首页</a>
                    </li>
                    
                    <li class="nav-item">
                        <a class="nav-link" href="/projects">项目</a>
                    </li>
                    
                    <li class="nav-item">
                        <a class="nav-link" href="/essays">随笔</a>
                    </li>
                    
                    <li class="nav-item">
                        <a class="nav-link" href="/notes">笔记</a>
                    </li>
                    
                </ul>

                <!--
                <form class="d-flex" role="search">
                    <input class="form-control me-2" type="search" placeholder="" aria-label="Search">
                    <button class="btn btn-outline-success" type="submit">搜索</button>
                </form>
                -->
            </div>
        </div>
    </nav>
</div>

    
    
</header>

    <main><div class="post">
    <h3 class="title">spring-ioc容器配置的3种方式</h3>

    <div class="meta">
        <div>
            <span class="page-class"></span>
            <span>: </span>
            <a class="cate" href="//#SpringFramework">SpringFramework</a>
        </div>
        <div class="date">
            <span>发布于</span>
            <span>: </span>
            <span>2022-10-11</span>
        </div>
    </div>

    <div class="content"><span id="more"></span>

<h1 id="基于XML的容器配置"><a href="#基于XML的容器配置" class="headerlink" title="基于XML的容器配置"></a>基于XML的容器配置</h1><h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2><p><img src="/images/collections.png"></p>
<h2 id="p-namespace和c-namespace"><a href="#p-namespace和c-namespace" class="headerlink" title="p-namespace和c-namespace"></a>p-namespace和c-namespace</h2><p>p命名空间是在使用setter方式注入时，设置属性值的快捷方式</p>
<p>使用前需要添加命名空间p</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns:p</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/p&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;beanOne&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;entity.BeanOne&quot;</span> <span class="hljs-attr">p:num</span>=<span class="hljs-string">&quot;100&quot;</span> <span class="hljs-attr">p:text</span>=<span class="hljs-string">&quot;hello spring&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span></code></pre>

<p>c命名空间是在使用构造器方式注入时，设置构造器参数的快捷方式</p>
<p>使用前需要添加命名空间c</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns:c</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/c&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;beanOne&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;entity.BeanOne&quot;</span> <span class="hljs-attr">c:num</span>=<span class="hljs-string">&quot;100&quot;</span> <span class="hljs-attr">c:text</span>=<span class="hljs-string">&quot;hello spring&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span></code></pre>

<p>c-namespace除了使用参数名进行匹配，也支持索引形式的参数匹配方式，例如</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;beanOne&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;entity.BeanOne&quot;</span> <span class="hljs-attr">c:_0</span>=<span class="hljs-string">&quot;100&quot;</span> <span class="hljs-attr">c:_1</span>=<span class="hljs-string">&quot;hello spring&quot;</span>/&gt;</span></code></pre>

<h2 id="Bean的作用域"><a href="#Bean的作用域" class="headerlink" title="Bean的作用域"></a>Bean的作用域</h2><p>spring原生支持6个作用域</p>
<p><img src="/images/bean-scopes.png"></p>
<p>使用<code>scope</code>配置</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;beanTwo&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;entity.BeanTwo&quot;</span> <span class="hljs-attr">scope</span>=<span class="hljs-string">&quot;singleton&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span></code></pre>

<h2 id="延迟初始化Bean"><a href="#延迟初始化Bean" class="headerlink" title="延迟初始化Bean"></a>延迟初始化Bean</h2><p>默认情况下，ApplicationContext会在应用首次启动时，就实例化所有的单例Bean(<code>scope=&quot;singleton&quot;</code>)。</p>
<p>如果不需要这种行为，而是需要在获取Bean的时候进行实例化，只要添加 <code>lazy-init=&quot;true&quot;</code> 配置即可</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;beanThree&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;entity.BeanThree&quot;</span> <span class="hljs-attr">lazy-init</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">constructor-arg</span> <span class="hljs-attr">index</span>=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;beanOne&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">constructor-arg</span> <span class="hljs-attr">index</span>=<span class="hljs-string">&quot;1&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;beanTwo&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span></code></pre>

<h2 id="自动装配"><a href="#自动装配" class="headerlink" title="自动装配"></a>自动装配</h2><p>支持以下几种模式</p>
<p><img src="/images/autowiring-modes.png"></p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;beanThree&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;entity.BeanThree&quot;</span> <span class="hljs-attr">autowire</span>=<span class="hljs-string">&quot;byName&quot;</span>/&gt;</span></code></pre>

<h2 id="别名"><a href="#别名" class="headerlink" title="别名"></a>别名</h2><p>可以使用<code>alias</code>标签给bean声明其它名字</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">alias</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;beanOne&quot;</span> <span class="hljs-attr">alias</span>=<span class="hljs-string">&quot;one&quot;</span>/&gt;</span></code></pre>

<h2 id="导入其它bean配置文件"><a href="#导入其它bean配置文件" class="headerlink" title="导入其它bean配置文件"></a>导入其它bean配置文件</h2><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">import</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&quot;services.xml&quot;</span>/&gt;</span></code></pre>

<h1 id="基于注解的容器配置"><a href="#基于注解的容器配置" class="headerlink" title="基于注解的容器配置"></a>基于注解的容器配置</h1><p>使用基于注解的配置，需要在xml中声明<code>context</code>命名空间,并启用注解配置。</p>
<pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span>
<span class="hljs-tag">    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span>
<span class="hljs-tag">    <span class="hljs-attr">xmlns:context</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/context&quot;</span></span>
<span class="hljs-tag">    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span>
<span class="hljs-string"><span class="hljs-tag">        https://www.springframework.org/schema/beans/spring-beans.xsd</span></span>
<span class="hljs-string"><span class="hljs-tag">        http://www.springframework.org/schema/context</span></span>
<span class="hljs-string"><span class="hljs-tag">        https://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">context:annotation-config</span>/&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span></code></pre>

<p><strong><code>@Required</code></strong></p>
<p><strong><code>@Autowired</code></strong></p>
<p>自动装配，相当于xml配置中的autowire属性,默认使用<code>byType</code>和<code>byName</code>模式去匹配依赖项。当默认行为不能定位依赖项时，需要使用 <code>@Qualifier</code> 注解。</p>
<pre><code class="hljs java"><span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> BeanOne beanOne;
<span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> BeanTwo beanTwo;</code></pre>

<p><strong><code>@Qualifier</code></strong></p>
<p>限定符，修饰符，配合 <code>@Autowired</code>使用</p>
<pre><code class="hljs java"><span class="hljs-meta">@Autowired</span>
<span class="hljs-meta">@Qualifier(&quot;beanOne&quot;)</span>
<span class="hljs-keyword">private</span> BeanOne beanOne;</code></pre>

<p><strong><code>@Resource</code></strong></p>
<p>相当于<code>@Autowired</code>和<code>@Qualifier</code>的结合体，也是用于自动装配的，只不过默认先根据bean的id名，后根据类型进行匹配，可以使用name参数指定要匹配的bean。</p>
<pre><code class="hljs java"><span class="hljs-meta">@Resource(name=&quot;beanOne&quot;)</span>
<span class="hljs-keyword">private</span> BeanOne beanOne;
<span class="hljs-meta">@Resource</span>
<span class="hljs-keyword">private</span> BeanTwo beanTwo;</code></pre>

<p>如果JDK中没有Resource注解，需要引入jar包</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>javax.annotation<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>javax.annotation-api<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.3.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></code></pre>


<p><strong><code>@Primary</code></strong></p>
<p><strong><code>@Value</code></strong></p>
<p>给属性赋值,获者给setter方法传递实参</p>
<pre><code class="hljs java"><span class="hljs-meta">@Value(&quot;100&quot;)</span>
<span class="hljs-keyword">private</span> <span class="hljs-type">int</span> num;
<span class="hljs-meta">@Value(&quot;hello&quot;)</span>
<span class="hljs-keyword">private</span> String text;</code></pre>

<p><strong><code>@Scope</code></strong></p>
<p>作用域</p>
<pre><code class="hljs java"><span class="hljs-meta">@Scope(&quot;singleton&quot;)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BeanOne</span>&#123;&#125;</code></pre>

<h2 id="组件扫描"><a href="#组件扫描" class="headerlink" title="组件扫描"></a>组件扫描</h2><p>在xml配置中添加以下配置项,就可以使用组件扫描相关的注解了</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">context:component-scan</span> <span class="hljs-attr">base-package</span>=<span class="hljs-string">&quot;org.example&quot;</span>/&gt;</span></code></pre>

<p><strong><code>@Component</code></strong></p>
<p>声明一个类为组件，相当于在xml中通过bean标签注册。</p>
<p><strong><code>@Repository</code>, <code>@Service</code>, <code>@Controller</code></strong></p>
<p>都是<code>@Component</code>的别名，唯一的作用是增强语义，分别用于dao层，service层，controller层中的类上。</p>
<h1 id="完全基于Java的容器配置"><a href="#完全基于Java的容器配置" class="headerlink" title="完全基于Java的容器配置"></a>完全基于Java的容器配置</h1><p><strong><code>@Configuration</code></strong></p>
<p>声明配置类</p>
<p><strong><code>@Bean</code></strong></p>
<p>用在方法上，方法名就是bean的id名，也可以使用name注解参数定义为其它名字；方法的返回值就是bean对象。</p>
<p><strong><code>@ComponentScan</code></strong></p>
<p>组件扫描包路径</p>
<p><strong><code>@Import</code></strong></p>
<p>导入其它Java配置类</p>
<pre><code class="hljs java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-meta">@ComponentScan(basePackages=&#123;&quot;entity&quot;&#125;)</span>
<span class="hljs-meta">@Import(ServiceConfig.class)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AppConfig</span>
&#123;
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> BeanOne <span class="hljs-title function_">beanOne</span><span class="hljs-params">()</span>
    &#123;
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BeanOne</span>(<span class="hljs-number">100</span>,<span class="hljs-string">&quot;hello spring&quot;</span>);
    &#125;
&#125;</code></pre>

<p>使用<code>AnnotationConfigApplicationContext</code>加载配置类，获取bean对象</p>
<pre><code class="hljs java">ApplicationContext context=<span class="hljs-keyword">new</span> <span class="hljs-title class_">AnnotationConfigApplicationContext</span>(AppConfig.class);
BeanOne beanOne=context.getBean(<span class="hljs-string">&quot;beanOne&quot;</span>,BeanOne.class);</code></pre>
</div>
</div>

<div class="post-end">
    <span>----- </span>
    <span>THE END</span>
    <span> -----</span>
</div>

<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.1/dist/jquery.min.js"></script>
<script type="text/javascript">
    $(document).ready(() => {
        // 表格添加滚动条
        $('table').wrap("<div class='table-wrap' style='width: 100%; overflow: auto;'></div>");
    });

</script></main>

    <footer>

</footer>

    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script>
    
</body>
</html>